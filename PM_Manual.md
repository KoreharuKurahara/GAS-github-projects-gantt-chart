# プロジェクトマネージャー向け利用マニュアル

このツールは、GitHub Projectsで管理しているタスク状況を、Googleスプレッドシート上のガントチャートとして可視化・同期するためのものです。

## 概要

*   **GitHub Projects → Google Sheets**: タスクのタイトル、ステータス、期間などを取得し、ガントチャートを描画します。
*   **予実管理**: 「予定」と「実際」の期間を並べて表示し、スケジュールのズレを可視化します。
*   **自動記録**: タスクのステータス変更（着手/完了）を検知し、開始日・終了日を自動記録する機能があります（オプション）。

## 準備：GitHub Projectの設定

GitHub Project側で以下のカスタムフィールドまたは設定が必要です。

### 必須設定（基本）
| フィールド名 | タイプ | 説明 |
| :--- | :--- | :--- |
| **Status** | Single Select | `Todo`, `In Progress`, `Done` などのステータス管理用。 |
| **StartDate** | Date | **予定開始日**。タスクの計画上の開始日を入力します。これによりガントチャートの「予定」バーが描画されます。 |
| **EndDate** | Date | **予定終了日**。タスクの計画上の終了日を入力します。 |

### 推奨設定（より便利に）
| フィールド名 | 設定 | 説明 |
| :--- | :--- | :--- |
| **Iteration** | Iteration | **スプリント/イテレーション**。`StartDate`や`EndDate`が未入力の場合、このIterationの期間が自動的に代用されます（フォールバック機能）。 |

### オプション設定（予実管理用）
以下のフィールドを作成しておくと、実績の自動記録が可能になります。**作成しなくてもツールは動作します。**

| フィールド名 | タイプ | 説明 |
| :--- | :--- | :--- |
| **RealStartDate** | Date | **実績開始日**。ステータスを `In Progress` に変更した際、ツールが自動的に今日の日付を入力します。 |
| **RealEndDate** | Date | **実績終了日**。ステータスを `Done` に変更した際、ツールが自動的に今日の日付を入力します。 |

> [!TIP]
> `RealStart/EndDate` フィールドがないプロジェクトでも、同期機能や「予定」の表示は問題なく動作します。

## 日々の運用フロー

1.  **GitHub Projectでタスクを管理する**
    *   `StartDate`, `EndDate` で計画を立てます（またはIterationを割り当てます）。
    *   タスクに着手したら Status を `In Progress` にします。
    *   タスクが完了したら Status を `Done` にします。

2.  **Googleスプレッドシートで同期する**
    *   スプレッドシートのメニュー（またはボタン）から同期スクリプトを実行します。
    *   最新のGitHubの状況がシートに反映され、ガントチャートが再描画されます。

## 知っておくと便利な仕様

### 1. 日付の自動補完ロジック
「予定日」が空欄の場合、ツールは以下の優先順位で日付を表示しようとします。

1.  **`StartDate` / `EndDate` フィールド**: ここに入力があれば最優先で使用されます。
2.  **Iteration (Sprint)**: 上記が空で、かつIterationが設定されている場合、そのIterationの開始日・終了日が代用されます。
    *   *例：「開発タスクA」の日付が未定でも、"Sprint 1 (1/1~1/14)" に入っていれば、チャート上では1/1~1/14として表示されます。*

### 2. 実績日の自動記録
`RealStartDate` / `RealEndDate` フィールドがあるプロジェクトでは、以下のタイミングで日付が書き込まれます。

*   **着手時**: Status が `In Progress` になり、かつ `RealStartDate` が空の場合 → **今日の日付**を記入。
*   **完了時**: Status が `Done` になり、かつ `RealEndDate` が空の場合 → **今日の日付**を記入。

これにより、PMがいちいち実績日を手入力しなくても、メンバーがステータスを変えるだけで予実管理データが蓄積されます。

## トラブルシューティング

**Q. ガントチャートが表示されない/真っ白になる**
*   A. 対象のタスクに「開始日/終了日」または「Iteration」が設定されているか確認してください。期間情報が全くないタスクはチャートに線が引けません。

**Q. 「RealStartDateが見つかりません」といったエラーは出る？**
*   A. いいえ。フィールドが存在しない場合は、単純にその機能（自動記録）がスキップされるだけで、エラーにはなりません。
